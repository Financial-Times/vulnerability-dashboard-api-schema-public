{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$ref": "#/definitions/Team",
  "description": "Number of findings owned by individual Team",
  "definitions": {
    "Team": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "integer",
          "description": "Team product type id found in DefectDojo"
        },
        "code": {
          "$ref": "#/definitions/Code"
        },
        "updated": {
          "type": "string",
          "description": "Date and time when vulnerabilities for each team has been refreshed"
        },
        "name": {
          "$ref": "#/definitions/TeamName"
        },
        "groupName": {
          "$ref": "#/definitions/Name"
        },
        "systems": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/System"
          }
        },
        "nonSystemSnykProjects": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/NonSystemSnykProject"
          }
        },
        "totalSystemSnykFindings": {
          "type": "integer",
          "description": "Number of snyk findings that belong to a system definded in bizops"
        },
        "totalNonSystemSnykFindings": {
          "type": "integer",
          "description": "Number of snyk findings that belong to a package defined in bizops"
        },
        "totalSnykFindings": {
          "type": "integer",
          "description": "Overall number of snyk findings belonging to team"
        },
        "totalDdFindings": {
          "type": "integer",
          "description": "Overall number of DefectDojo findings belonging to team"
        },
        "totalFindings": {
          "type": "integer",
          "description": "Grand total of findings: totalSnykFindings + totalDdFindings"
        },
        "findingsOverSla": {
          "$ref": "#/definitions/FindingsOverSla"
        },
        "systemsCount": {
          "type": "integer",
          "description": "Number of systems owned by this team"
        },
        "scannedSystemsCount": {
          "type": "integer",
          "description": "Number of systems owned by this team which are being scanned by at least one vulnerability tool"
        }
      },
      "required": [
        "code",
        "findingsOverSla",
        "groupName",
        "id",
        "name",
        "nonSystemSnykProjects",
        "systemsCount",
        "scannedSystemsCount",
        "systems",
        "totalDdFindings",
        "totalFindings",
        "totalNonSystemSnykFindings",
        "totalSnykFindings",
        "totalSystemSnykFindings",
        "updated"
      ],
      "title": "Team"
    },
    "FindingsOverSla": {
      "type": "object",
      "description": "Number of findings grouped by severity that have gone pass sla - https://docs.google.com/document/d/1XXfYyNG5Qvtxb-hE7o4MhYWxZarQEe8hby38a8bOq4w",
      "additionalProperties": false,
      "properties": {
        "medium": {
          "type": "integer"
        },
        "low": {
          "type": "integer"
        },
        "high": {
          "type": "integer"
        },
        "critical": {
          "type": "integer"
        }
      },
      "required": [],
      "title": "FindingsOverSla"
    },
    "NonSystemSnykProject": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Snyk project id"
        },
        "name": {
          "type": "string",
          "description": "Name of Snyk project"
        },
        "created": {
          "type": "string",
          "description": "Date and time of when snyk project was created"
        },
        "origin": {
          "$ref": "#/definitions/Origin"
        },
        "type": {
          "$ref": "#/definitions/Type"
        },
        "readOnly": {
          "type": "boolean"
        },
        "testFrequency": {
          "$ref": "#/definitions/TestFrequency"
        },
        "isMonitored": {
          "type": "boolean",
          "description": "Check if snyk project is continuously monitored for open source vulnerabilities and license issues"
        },
        "totalDependencies": {
          "type": "integer",
          "description": "Total number of dependencies in snyk project"
        },
        "issueCountsBySeverity": {
          "$ref": "#/definitions/FindingsOverSla"
        },
        "imageTag": {
          "$ref": "#/definitions/NonSystemSnykProjectImageTag"
        },
        "imagePlatform": {
          "type": "string"
        },
        "imageBaseImage": {
          "type": "string"
        },
        "lastTestedDate": {
          "type": "string",
          "description": "Date and time when snyk last scanned depedencies"
        },
        "browseUrl": {
          "type": "string"
        },
        "owner": {
          "type": "null"
        },
        "importingUser": {
          "$ref": "#/definitions/ImportingUser"
        },
        "tags": {
          "type": "array",
          "description": "Additional tags in Snyk Project",
          "items": {}
        },
        "attributes": {
          "$ref": "#/definitions/Attributes"
        },
        "branch": {
          "anyOf": [
            {
              "$ref": "#/definitions/Branch"
            },
            {
              "type": "null"
            }
          ]
        },
        "orgId": {
          "type": "string",
          "description": "Snyk org ID"
        },
        "orgName": {
          "$ref": "#/definitions/Name"
        },
        "orgSlug": {
          "$ref": "#/definitions/OrgSlug"
        },
        "repoCode": {
          "type": "string",
          "description": "Name of Github organisation and repo"
        },
        "totalSnykIssuesIncludingLicenceIssues": {
          "type": "integer",
          "description": "Total number of issues found in snyk project"
        },
        "totalSnykVulnerabilities": {
          "type": "integer",
          "description": "Total number of issues found in snyk project, excluding licence issues"
        },
        "issues": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/NonSystemSnykProjectIssue"
          }
        },
        "repoSystemData": {
          "type": "array",
          "items": {}
        },
        "repoTeamCode": {
          "$ref": "#/definitions/Code"
        },
        "totalFindings": {
          "type": "integer",
          "description": "Total number of findings"
        },
        "snykIssuesOverSla": {
          "$ref": "#/definitions/SnykIssuesOverSla"
        },
        "remoteRepoUrl": {
          "type": "string",
          "description": "Github repository link"
        }
      },
      "required": [
        "attributes",
        "branch",
        "browseUrl",
        "created",
        "id",
        "imageTag",
        "importingUser",
        "isMonitored",
        "issueCountsBySeverity",
        "issues",
        "lastTestedDate",
        "name",
        "orgId",
        "orgName",
        "orgSlug",
        "origin",
        "owner",
        "readOnly",
        "repoCode",
        "repoTeamCode",
        "snykIssuesOverSla",
        "tags",
        "testFrequency",
        "totalDependencies",
        "totalFindings",
        "totalSnykIssuesIncludingLicenceIssues",
        "totalSnykVulnerabilities",
        "type"
      ],
      "title": "NonSystemSnykProject"
    },
    "Attributes": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "criticality": {
          "type": "array",
          "items": {}
        },
        "lifecycle": {
          "type": "array",
          "items": {}
        },
        "environment": {
          "type": "array",
          "items": {}
        }
      },
      "required": ["criticality", "environment", "lifecycle"],
      "title": "Attributes"
    },
    "ImportingUser": {
      "type": "object",
      "description": "Metadata about user who imported Snyk project",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "name": {
          "type": "string"
        },
        "username": {
          "type": "string"
        },
        "email": {
          "anyOf": [
            {
              "type": "null"
            },
            {
              "type": "string"
            }
          ]
        }
      },
      "required": ["email", "id", "name", "username"],
      "title": "ImportingUser"
    },
    "NonSystemSnykProjectIssue": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "issueType": {
          "$ref": "#/definitions/IssueType"
        },
        "pkgName": {
          "type": "string"
        },
        "pkgVersions": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "priorityScore": {
          "type": "integer"
        },
        "priority": {
          "$ref": "#/definitions/Priority"
        },
        "issueData": {
          "$ref": "#/definitions/IssueData"
        },
        "isPatched": {
          "type": "boolean"
        },
        "isIgnored": {
          "type": "boolean"
        },
        "fixInfo": {
          "$ref": "#/definitions/FixInfo"
        },
        "links": {
          "$ref": "#/definitions/Links"
        },
        "issueAgeDays": {
          "type": "integer"
        },
        "issueAge": {
          "type": "string"
        },
        "hasRemediation": {
          "type": "array",
          "items": {}
        },
        "formattedPublicationTime": {
          "type": "string"
        },
        "link": {
          "type": "string"
        },
        "severity": {
          "$ref": "#/definitions/IssueDataSeverity"
        }
      },
      "required": [
        "fixInfo",
        "formattedPublicationTime",
        "hasRemediation",
        "id",
        "isIgnored",
        "isPatched",
        "issueAge",
        "issueAgeDays",
        "issueData",
        "issueType",
        "link",
        "links",
        "pkgName",
        "pkgVersions",
        "priority",
        "priorityScore",
        "severity"
      ],
      "title": "NonSystemSnykProjectIssue"
    },
    "FixInfo": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "isUpgradable": {
          "type": "boolean"
        },
        "isPinnable": {
          "type": "boolean"
        },
        "isPatchable": {
          "type": "boolean"
        },
        "isFixable": {
          "type": "boolean"
        },
        "isPartiallyFixable": {
          "type": "boolean"
        },
        "nearestFixedInVersion": {
          "type": "string"
        },
        "fixedIn": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "fixedIn",
        "isFixable",
        "isPartiallyFixable",
        "isPatchable",
        "isPinnable",
        "isUpgradable",
        "nearestFixedInVersion"
      ],
      "title": "FixInfo"
    },
    "IssueData": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "title": {
          "type": "string"
        },
        "severity": {
          "$ref": "#/definitions/IssueDataSeverity"
        },
        "url": {
          "type": "string"
        },
        "identifiers": {
          "type": "object",
          "additionalProperties": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        },
        "credit": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "exploitMaturity": {
          "$ref": "#/definitions/ExploitMaturity"
        },
        "semver": {
          "$ref": "#/definitions/Semver"
        },
        "publicationTime": {
          "type": "string"
        },
        "disclosureTime": {
          "type": "string"
        },
        "CVSSv3": {
          "type": "string"
        },
        "cvssScore": {
          "type": "number"
        },
        "language": {
          "$ref": "#/definitions/Language"
        },
        "patches": {
          "type": "array",
          "items": {}
        },
        "nearestFixedInVersion": {
          "type": "string"
        },
        "isMaliciousPackage": {
          "type": "boolean"
        }
      },
      "required": [
        "CVSSv3",
        "credit",
        "cvssScore",
        "disclosureTime",
        "exploitMaturity",
        "id",
        "identifiers",
        "isMaliciousPackage",
        "language",
        "nearestFixedInVersion",
        "patches",
        "publicationTime",
        "semver",
        "severity",
        "title",
        "url"
      ],
      "title": "IssueData"
    },
    "Semver": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "vulnerable": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "required": ["vulnerable"],
      "title": "Semver"
    },
    "Links": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "paths": {
          "type": "string"
        }
      },
      "required": ["paths"],
      "title": "Links"
    },
    "Priority": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "score": {
          "type": "integer"
        },
        "factors": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Factor"
          }
        }
      },
      "required": ["factors", "score"],
      "title": "Priority"
    },
    "Factor": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "name": {
          "$ref": "#/definitions/FactorName"
        },
        "description": {
          "type": "string"
        }
      },
      "required": ["description", "name"],
      "title": "Factor"
    },
    "SnykIssuesOverSla": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "medium": {
          "type": "integer"
        }
      },
      "required": [],
      "title": "SnykIssuesOverSla"
    },
    "System": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "integer"
        },
        "code": {
          "type": "string"
        },
        "findingsCount": {
          "type": "integer"
        },
        "findingsList": {
          "type": "array",
          "items": {
            "type": "integer"
          }
        },
        "teamId": {
          "type": "integer"
        },
        "serviceTier": {
          "$ref": "#/definitions/ServiceTier"
        },
        "lifecycle": {
          "$ref": "#/definitions/Lifecycle"
        },
        "scanTypes": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/ScanType"
          }
        },
        "findings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Finding"
          }
        },
        "snykProjects": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/SnykProject"
          }
        },
        "matchingSnykFindingsCount": {
          "type": "integer"
        },
        "totalFindings": {
          "type": "integer"
        },
        "findingsOverSla": {
          "$ref": "#/definitions/FindingsOverSla"
        }
      },
      "required": [
        "code",
        "findings",
        "findingsCount",
        "findingsList",
        "findingsOverSla",
        "id",
        "lifecycle",
        "matchingSnykFindingsCount",
        "scanTypes",
        "serviceTier",
        "snykProjects",
        "teamId",
        "totalFindings"
      ],
      "title": "System"
    },
    "Finding": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "integer",
          "description": "Finding ID found in DefectDojo"
        },
        "name": {
          "type": "string",
          "description": "Name of finding from DefectDojo"
        },
        "age": {
          "type": "string",
          "description": "How long finding has been open"
        },
        "active": {
          "type": "boolean",
          "description": "Finding status weather it is currently exploitable"
        },
        "severity": {
          "$ref": "#/definitions/FindingSeverity"
        },
        "created": {
          "type": "string",
          "description": "Date and time when finding was created in DefectDojo"
        },
        "foundBy": {
          "$ref": "#/definitions/FoundBy"
        },
        "remediation": {
          "anyOf": [
            {
              "type": "null"
            },
            {
              "type": "string"
            }
          ]
        },
        "ageDays": {
          "type": "integer",
          "description": "Number of days old for finding"
        },
        "link": {
          "type": "string"
        },
        "hasRemediation": {
          "type": "boolean"
        }
      },
      "required": [
        "active",
        "age",
        "ageDays",
        "created",
        "foundBy",
        "hasRemediation",
        "id",
        "link",
        "name",
        "remediation",
        "severity"
      ],
      "title": "Finding"
    },
    "SnykProject": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "ID of Snyk project"
        },
        "name": {
          "type": "string",
          "description": "Name of Snyk project"
        },
        "created": {
          "type": "string",
          "description": "Date and time for when snyk project was created"
        },
        "origin": {
          "$ref": "#/definitions/Origin"
        },
        "type": {
          "$ref": "#/definitions/Type"
        },
        "readOnly": {
          "type": "boolean"
        },
        "testFrequency": {
          "$ref": "#/definitions/TestFrequency"
        },
        "isMonitored": {
          "type": "boolean",
          "description": "Status is project is being continuously monitored for open source vulnerabilities and license issues"
        },
        "totalDependencies": {
          "type": "integer",
          "description": "Total amount of dependencies found in project manifest file"
        },
        "issueCountsBySeverity": {
          "$ref": "#/definitions/FindingsOverSla"
        },
        "imageTag": {
          "$ref": "#/definitions/SnykProjectImageTag"
        },
        "imagePlatform": {
          "type": "string"
        },
        "imageBaseImage": {
          "type": "string"
        },
        "lastTestedDate": {
          "type": "string"
        },
        "browseUrl": {
          "type": "string",
          "description": "Snyk project link"
        },
        "owner": {
          "type": "null"
        },
        "importingUser": {
          "$ref": "#/definitions/ImportingUser"
        },
        "tags": {
          "type": "array",
          "items": {}
        },
        "attributes": {
          "$ref": "#/definitions/Attributes"
        },
        "branch": {
          "anyOf": [
            {
              "type": "null"
            },
            {
              "type": "string"
            }
          ]
        },
        "orgId": {
          "type": "string"
        },
        "orgName": {
          "$ref": "#/definitions/Name"
        },
        "orgSlug": {
          "$ref": "#/definitions/OrgSlug"
        },
        "repoCode": {
          "type": "string"
        },
        "totalSnykIssuesIncludingLicenceIssues": {
          "type": "integer",
          "description": "Total number of issues found in snyk project"
        },
        "totalSnykVulnerabilities": {
          "type": "integer",
          "description": "Total number of issues found in snyk project, excluding licence issues"
        },
        "issues": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/SnykProjectIssue"
          }
        },
        "repoSystemData": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/RepoSystemDatum"
          }
        },
        "repoTeamCode": {
          "$ref": "#/definitions/Code"
        },
        "remoteRepoUrl": {
          "type": "string"
        }
      },
      "required": [
        "attributes",
        "branch",
        "browseUrl",
        "created",
        "id",
        "imageTag",
        "importingUser",
        "isMonitored",
        "issueCountsBySeverity",
        "issues",
        "lastTestedDate",
        "name",
        "orgId",
        "orgName",
        "orgSlug",
        "origin",
        "owner",
        "readOnly",
        "repoCode",
        "repoSystemData",
        "repoTeamCode",
        "tags",
        "testFrequency",
        "totalDependencies",
        "totalSnykIssuesIncludingLicenceIssues",
        "totalSnykVulnerabilities",
        "type"
      ],
      "title": "SnykProject"
    },
    "SnykProjectIssue": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string"
        },
        "issueType": {
          "$ref": "#/definitions/IssueType"
        },
        "pkgName": {
          "type": "string"
        },
        "pkgVersions": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "priorityScore": {
          "type": "integer"
        },
        "priority": {
          "$ref": "#/definitions/Priority"
        },
        "issueData": {
          "$ref": "#/definitions/IssueData"
        },
        "isPatched": {
          "type": "boolean"
        },
        "isIgnored": {
          "type": "boolean"
        },
        "fixInfo": {
          "$ref": "#/definitions/FixInfo"
        },
        "links": {
          "$ref": "#/definitions/Links"
        },
        "issueAgeDays": {
          "type": "integer"
        },
        "issueAge": {
          "type": "string"
        },
        "hasRemediation": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "formattedPublicationTime": {
          "type": "string"
        },
        "link": {
          "type": "string"
        },
        "severity": {
          "$ref": "#/definitions/IssueDataSeverity"
        }
      },
      "required": [
        "fixInfo",
        "formattedPublicationTime",
        "hasRemediation",
        "id",
        "isIgnored",
        "isPatched",
        "issueAge",
        "issueAgeDays",
        "issueData",
        "issueType",
        "link",
        "links",
        "pkgName",
        "pkgVersions",
        "priority",
        "priorityScore",
        "severity"
      ],
      "title": "SnykProjectIssue"
    },
    "RepoSystemDatum": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "code": {
          "type": "string",
          "description": "The unique identification (systemcode) for this system"
        },
        "lifecycleStage": {
          "$ref": "#/definitions/LifecycleStage"
        },
        "serviceTier": {
          "$ref": "#/definitions/ServiceTier"
        },
        "deliveredBy": {
          "$ref": "#/definitions/DeliveredBy"
        }
      },
      "required": ["code", "deliveredBy", "lifecycleStage", "serviceTier"],
      "title": "RepoSystemDatum"
    },
    "DeliveredBy": {
      "type": "object",
      "additionalProperties": false,
      "description": "The team which delivers the system. Costs related to this system will be allocated to the Group this Team is a part of. More details here https://tech.in.ft.com/tech-topics/operability/biz-ops/system-ownership.",
      "properties": {
        "code": {
          "$ref": "#/definitions/Code"
        },
        "name": {
          "$ref": "#/definitions/TeamName"
        },
        "isThirdParty": {
          "type": "boolean"
        }
      },
      "required": ["code", "isThirdParty", "name"],
      "title": "DeliveredBy"
    },
    "Code": {
      "type": "string",
      "description": "The unique identification (systemcode) for this Team as found in Biz-Ops",
      "title": "Code"
    },
    "Name": {
      "type": "string",
      "description": "The group name whose hierarchy contains this team as found in Biz-Ops",
      "title": "Name"
    },
    "TeamName": {
      "type": "string",
      "description": "The short title for the team as found in Biz-Ops",
      "title": "TeamName"
    },
    "Branch": {
      "type": "string",
      "title": "Branch"
    },
    "NonSystemSnykProjectImageTag": {
      "type": "string",
      "title": "NonSystemSnykProjectImageTag"
    },
    "ExploitMaturity": {
      "type": "string",
      "title": "ExploitMaturity"
    },
    "Language": {
      "type": "string",
      "title": "Language"
    },
    "IssueDataSeverity": {
      "type": "string",
      "enum": ["medium", "high", "low", "critical", "info"],
      "title": "IssueDataSeverity"
    },
    "IssueType": {
      "type": "string",
      "title": "IssueType"
    },
    "FactorName": {
      "type": "string",
      "title": "FactorName"
    },
    "OrgSlug": {
      "type": "string",
      "title": "OrgSlug"
    },
    "Origin": {
      "type": "string",
      "title": "Origin"
    },
    "TestFrequency": {
      "type": "string",
      "title": "TestFrequency"
    },
    "Type": {
      "type": "string",
      "title": "Type"
    },
    "FoundBy": {
      "type": "string",
      "enum": ["Nessus Scan", "Nikto Scan", "Nmap Scan", "Snyk API"],
      "title": "FoundBy"
    },
    "FindingSeverity": {
      "type": "string",
      "enum": ["Medium", "Low", "Info", "Critical", "High"],
      "title": "FindingSeverity"
    },
    "Lifecycle": {
      "type": "string",
      "title": "Lifecycle"
    },
    "ScanType": {
      "type": "string",
      "enum": ["nessus", "nikto", "sslscan", "nmap", "snyk"],
      "title": "ScanType"
    },
    "ServiceTier": {
      "type": "string",
      "enum": ["Bronze", "Gold", "Unsupported", "Silver", "Platinum"],
      "title": "ServiceTier"
    },
    "SnykProjectImageTag": {
      "type": "string",
      "title": "SnykProjectImageTag"
    },
    "LifecycleStage": {
      "type": "string",
      "title": "LifecycleStage"
    }
  }
}
